(defun read-file (path)
  (with-open-file (stream path)
    (loop for line = (read-line stream nil)
	  while line
	  collect line)))

(defun get-content-as-numbers (path)
  (mapcar #'parse-integer (read-file path)))

(defun create-2020-tuple (path)
  (let ((c (get-content-as-numbers path)))
    (loop for i in c
	  collect (loop for j in c
			when (= (+ i j) 2020)
			collect `(,i ,j)))))

(defun find-2020 (path)
  (let ((c (create-2020-tuple path)))
    (remove-if #'null c)))

(defun create-result (path)
  (let ((r (caar (find-2020 path))))
    (apply '* r)))

(create-result "input.txt")
